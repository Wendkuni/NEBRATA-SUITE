<mat-card>
  <mat-card-header>
    <mat-card-subtitle>
        <h3>
            <span *ngIf="delivranceAap">Dossier: [{{delivranceAap.numero}}] {{delivranceAap.etat.libelle}}</span>
        </h3>
    </mat-card-subtitle>


    <ng-container *ngIf="delivranceAap && !noOpenActions && delivranceAap?.transitions?.length>0">
      <app-action-detail-dossier [numero]="delivranceAap.numero" [url]="urlAction" [transitions]="delivranceAap.transitions"></app-action-detail-dossier>
    </ng-container>
  </mat-card-header>
    <form class="user-form" *ngIf="delivranceAap">
        <mat-card-content>
            <mat-tab-group class="mat-tab-active-color"  [(selectedIndex)]="selectedTabIndex">

                <mat-tab>
                    <form>
                        <ng-template mat-tab-label>
                            <mat-icon>content_paste</mat-icon>
                            Formalite
                        </ng-template>
                        <mat-tab-group  [(selectedIndex)]="selectedSubTabIndex">
                            <mat-tab>
                                <form>
                                    <ng-template mat-tab-label>
                                        <mat-icon>content_paste</mat-icon>
                                        Informations de base
                                    </ng-template>
                                    <div fxLayout="row" fxLayout.lt-md="row wrap" fxLayoutGap.gt-sm="20px" fxLayoutAlign="start">
                                        <mat-form-field class="sycad-form-line" appearance="outline" [fxFlex.xs]="100"
                                            [fxFlex.sm]="100" [fxFlex.md]="45" [fxFlex.lg]="25" [fxFlex.xl]="20">
                                            <mat-label>Numéro </mat-label>
                                            <input matInput value="{{delivranceAap.numero}}" [readonly]="true">
                                        </mat-form-field>
                                        <mat-form-field class="sycad-form-line" appearance="outline" [fxFlex.xs]="100"
                                            [fxFlex.sm]="100" [fxFlex.md]="45" [fxFlex.lg]="25" [fxFlex.xl]="20">
                                            <mat-label>Date création du dossier (*)</mat-label>
                                            <input matInput value="{{delivranceAap.dateCreationDossier | date:'dd/MM/yyyy'}}"
                                                [readonly]="true">

                                        </mat-form-field>
                                    </div> 
                                   
                                    <div fxLayout="row" fxLayout.lt-md="row wrap" fxLayoutGap.gt-sm="20px" fxLayoutAlign="start">
                                        <mat-form-field class="sycad-form-line" appearance="outline" [fxFlex.xs]="201"
                                            [fxFlex.sm]="201" [fxFlex.md]="91" [fxFlex.lg]="51" [fxFlex.xl]="41">
                                            <mat-label>Objet </mat-label>
                                            <input matInput [attr.autocomplete]="'off'" value="{{delivranceAap.objet}}"
                                                [readonly]="true" />
                                        </mat-form-field>
                                       
                                    </div>

                                    <div fxLayout="row" fxLayout.lt-md="row wrap" fxLayoutGap.gt-sm="20px" fxLayoutAlign="start">
                                        <mat-form-field class="sycad-form-line" appearance="outline" [fxFlex.xs]="100"
                                            [fxFlex.sm]="100" [fxFlex.md]="45" [fxFlex.lg]="25" [fxFlex.xl]="20">
                                            <mat-label>Date de la demande (*)</mat-label>
                                            <input matInput value="{{delivranceAap.dateExterne | date:'dd/MM/yyyy'}}"
                                                [readonly]="true">
                                        </mat-form-field>
                                        <mat-form-field class="sycad-form-line" appearance="outline" [fxFlex.xs]="100"
                                            [fxFlex.sm]="100" [fxFlex.md]="45" [fxFlex.lg]="25" [fxFlex.xl]="20">
                                            <mat-label>Référence de la demande </mat-label>
                                            <input matInput [attr.autocomplete]="'off'" value="{{delivranceAap.refExterne}}"
                                                [readonly]="true" />
                                        </mat-form-field>
                                    </div>
                                    
                                    <div *ngIf="delivranceAap.documentCession" fxLayout="row" fxLayout.lt-md="row wrap" fxLayoutGap.gt-sm="20px" fxLayoutAlign="start">
                                        <mat-form-field class="sycad-form-line" appearance="outline" [fxFlex.xs]="100"
                                            [fxFlex.sm]="100" [fxFlex.md]="45" [fxFlex.lg]="25" [fxFlex.xl]="20">
                                            <mat-label>Date attribution </mat-label>
                                            <input matInput  value="{{delivranceAap.documentCession.dateDoc| date:'dd/MM/yyyy'}}"
                                                [readonly]="true" />
                                        </mat-form-field>
                                        <mat-form-field class="sycad-form-line" appearance="outline" [fxFlex.xs]="100"
                                            [fxFlex.sm]="100" [fxFlex.md]="45" [fxFlex.lg]="25" [fxFlex.xl]="20">
                                            <mat-label>Numéro du PV </mat-label>
                                            <input matInput  value="{{delivranceAap.documentCession.numero}}"
                                                [readonly]="true" />
                                        </mat-form-field>
                                    </div>
                                    <div fxLayout="row" fxLayout.lt-md="row wrap" fxLayoutGap.gt-sm="20px" fxLayoutAlign="start">
                                        <mat-form-field *ngIf="delivranceAap.parcelle" class="sycad-form-line" appearance="outline" [fxFlex.xs]="100"
                                            [fxFlex.sm]="100" [fxFlex.md]="45" [fxFlex.lg]="25" [fxFlex.xl]="20">
                                            <mat-label>Date limite de mise en valeur </mat-label>
                                            <input matInput  value="{{delivranceAap?.parcelle['delaiDeMiseEnValeur'] | date:'dd/MM/yyyy'}}"
                                                [readonly]="true" />
                                        </mat-form-field>
                                        <mat-form-field class="sycad-form-line" appearance="outline" [fxFlex.xs]="100"
                                            [fxFlex.sm]="100" [fxFlex.md]="45" [fxFlex.lg]="25" [fxFlex.xl]="20">
                                            <mat-label>Etat de traitement du dossier </mat-label>
                                            <input matInput  value="{{delivranceAap.statusDossier}}"
                                                [readonly]="true" />
                                        </mat-form-field>
                                    </div>
                                    <div *ngIf="delivranceAap.statusDossier == 'ANNULE'" fxLayout="row" fxLayout.lt-md="row wrap" fxLayoutGap.gt-sm="20px" fxLayoutAlign="start">

                                        <mat-form-field class="sycad-form-line" appearance="outline" [fxFlex.xs]="100" [fxFlex.sm]="100" [fxFlex.md]="45" [fxFlex.lg]="25" [fxFlex.xl]="20">
                                          <mat-label>Motif(Annulé/rejet)</mat-label>
                                          <input matInput value="{{delivranceAap?.motifRejet?.libelle}}" [readonly]="true">
                                        </mat-form-field>
                                      </div>
                                </form>
                            </mat-tab>
                            <mat-tab>
                                <form>
                                    <ng-template mat-tab-label>
                                        <mat-icon>attach_file</mat-icon>
                                        Pièces fournies
                                    </ng-template>
                                    <table mat-table [dataSource]="dataSourcePiece" class="mat-elevation-z8" [fxFlex.xs]="100"
                                        [fxFlex.sm]="100" [fxFlex.md]="90" [fxFlex.lg]="80" [fxFlex.xl]="70">
                                        <ng-container matColumnDef="categorie">
                                            <th mat-header-cell *matHeaderCellDef> Catégorie</th>
                                            <td mat-cell *matCellDef="let listPiece"> {{listPiece.categorie?.categoriePiece?.libelle}}
                                            </td>
                                        </ng-container>
                                        <ng-container matColumnDef="reference">
                                            <th mat-header-cell *matHeaderCellDef> Référence </th>
                                            <td mat-cell *matCellDef="let listPiece"> {{listPiece.reference}} </td>
                                        </ng-container>
                                        <ng-container matColumnDef="autorite">
                                            <th mat-header-cell *matHeaderCellDef> Autorité de délivrance </th>
                                            <td mat-cell *matCellDef="let listPiece"> {{listPiece.autoriteDeDelivrance}} </td>
                                        </ng-container>
                                        <ng-container matColumnDef="dateDelivrance">
                                            <th mat-header-cell *matHeaderCellDef> Date de délivrance </th>
                                            <td mat-cell *matCellDef="let listPiece"> {{listPiece.dateDelivrance | date: 'dd/MM/yyyy'}}
                                            </td>
                                        </ng-container>
                                        <ng-container matColumnDef="dateExpiration">
                                            <th mat-header-cell *matHeaderCellDef> Date d'expiration </th>
                                            <td mat-cell *matCellDef="let listPiece"> {{listPiece.dateExpiration| date: 'dd/MM/yyyy'}}
                                            </td>
                                        </ng-container>
                                        <ng-container matColumnDef="imageUrl">
                                            <th mat-header-cell *matHeaderCellDef> Pièce jointe </th>
                                            <td mat-cell *matCellDef="let listPiece">

                                              <span *ngIf="!listPiece.pieceJointe">Aucune pièce jointe</span>
                                              <ng-container *ngIf="listPiece.pieceJointe">
                                                <span *ngFor="let piece of listPiece.pieceJointe; let i = index"  class="piece-telechargeable"> <a   href="{{piece | generalDownload}}">Télécharger {{i+1}}</a></span>
                                              </ng-container>
                                          </td>
                                        </ng-container>
                                        <tr mat-header-row *matHeaderRowDef="displayedColumnsPiece"></tr>
                                        <tr mat-row *matRowDef="let row; columns: displayedColumnsPiece;"></tr>
                                    </table>
                                </form>
                            </mat-tab>
                            <mat-tab>
                                <form>
                                    <ng-template mat-tab-label>
                                        <mat-icon>list_alt</mat-icon>
                                        Titres et actes
                                    </ng-template>
                                    <div *ngIf="delivranceAap.documentDeSortie">
                                        <div fxLayout="row" fxLayout.lt-md="row wrap" fxLayoutGap.gt-sm="20px" fxLayoutAlign="start">
                                            <mat-form-field class="sycad-form-line" appearance="outline" [fxFlex.xs]="100" [fxFlex.sm]="100" [fxFlex.md]="45" [fxFlex.lg]="25" [fxFlex.xl]="20">
                                                <mat-label>Libellé </mat-label>
                                                <input matInput value="{{delivranceAap.documentDeSortie.libelle}}" [readonly]="true">
                                            </mat-form-field>
                                            <mat-form-field class="sycad-form-line" appearance="outline" [fxFlex.xs]="100" [fxFlex.sm]="100" [fxFlex.md]="45" [fxFlex.lg]="25" [fxFlex.xl]="20">
                                                <mat-label>Numéro </mat-label>
                                                <input matInput value="{{delivranceAap.documentDeSortie.numero}}" [readonly]="true">
                                            </mat-form-field>

                                        </div>
                                        <div fxLayout="row" fxLayout.lt-md="row wrap" fxLayoutGap.gt-sm="20px" fxLayoutAlign="start">

                                            <mat-form-field class="sycad-form-line" appearance="outline" [fxFlex.xs]="100" [fxFlex.sm]="100" [fxFlex.md]="45" [fxFlex.lg]="25" [fxFlex.xl]="20">
                                                <mat-label>Date document</mat-label>
                                                <input matInput value="{{delivranceAap.documentDeSortie.dateDoc | date:'dd/MM/yyyy'}}" [readonly]="true">

                                            </mat-form-field>
                                            <mat-form-field class="sycad-form-line" appearance="outline" [fxFlex.xs]="100" [fxFlex.sm]="100" [fxFlex.md]="45" [fxFlex.lg]="25" [fxFlex.xl]="20">
                                                <mat-label>Date validité</mat-label>
                                                <input matInput value="{{delivranceAap.documentDeSortie.dateValidite | date:'dd/MM/yyyy'}}" [readonly]="true">

                                            </mat-form-field>
                                        </div>
                                        <div fxLayout="row" fxLayout.lt-md="row wrap" fxLayoutGap.gt-sm="20px" fxLayoutAlign="start">

                                            <mat-form-field class="sycad-form-line" appearance="outline" [fxFlex.xs]="100" [fxFlex.sm]="100" [fxFlex.md]="45" [fxFlex.lg]="25" [fxFlex.xl]="20">
                                                <mat-label>Type de document</mat-label>
                                                <input matInput value="{{delivranceAap.documentDeSortie?.documentType?.libelle}}" [readonly]="true">

                                            </mat-form-field>
                                            <mat-form-field class="sycad-form-line" appearance="outline" [fxFlex.xs]="100" [fxFlex.sm]="100" [fxFlex.md]="45" [fxFlex.lg]="25" [fxFlex.xl]="20">
                                                <mat-label>Est titre parcelle</mat-label>
                                                <input matInput value="{{delivranceAap.documentDeSortie?.documentType?.estTitreParcelle | showBooleanValue}}" [readonly]="true">

                                            </mat-form-field>

                                        </div>
                                        <div fxLayout="row" fxLayout.lt-md="row wrap" fxLayoutGap.gt-sm="20px" fxLayoutAlign="start">

                                            <mat-form-field class="sycad-form-line" appearance="outline" [fxFlex.xs]="100" [fxFlex.sm]="100" [fxFlex.md]="45" [fxFlex.lg]="25" [fxFlex.xl]="20">
                                                <mat-label>Titre actif</mat-label>
                                                <input matInput value="{{delivranceAap.documentDeSortie?.actif | showBooleanValue}}" [readonly]="true">

                                            </mat-form-field>

                                           
                                        </div>
                                        <div fxLayout="row" fxLayout.lt-md="row wrap" fxLayoutGap.gt-sm="20px" fxLayoutAlign="start">

                                            <mat-form-field class="sycad-form-line" appearance="outline" [fxFlex.xs]="100" [fxFlex.sm]="100" [fxFlex.md]="45" [fxFlex.lg]="25" [fxFlex.xl]="20">
                                                <mat-label>Est titre foncier</mat-label>
                                                <input matInput value="{{delivranceAap.documentDeSortie?.documentType?.estTitreFoncier | showBooleanValue}}" [readonly]="true">

                                            </mat-form-field>

                                            <mat-form-field class="sycad-form-line" appearance="outline" [fxFlex.xs]="100" [fxFlex.sm]="100" [fxFlex.md]="45" [fxFlex.lg]="25" [fxFlex.xl]="20">
                                                <mat-label>Date de retrait</mat-label>
                                                <input matInput value="{{delivranceAap.documentDeSortie.dateRetrait | date:'dd/MM/yyyy'}}" [readonly]="true">

                                            </mat-form-field>
                                        </div>
                                        <div fxLayout="row" fxLayout.lt-md="row wrap" fxLayoutGap.gt-sm="20px" fxLayoutAlign="start">

                                            <div [fxFlex.xs]="100" [fxFlex.sm]="100" [fxFlex.md]="45" [fxFlex.lg]="25" [fxFlex.xl]="20">
                                                <span *ngIf="delivranceAap.documentDeSortie.pieceJointe && delivranceAap.documentDeSortie.pieceJointe.length > 0"> <a href="{{delivranceAap.documentDeSortie.pieceJointe | generalDownload}}">Télécharger le document validé et non signe</a></span>
                                            </div>
                                            <div [fxFlex.xs]="100" [fxFlex.sm]="100" [fxFlex.md]="45" [fxFlex.lg]="25" [fxFlex.xl]="20">
                                                <span *ngIf="delivranceAap.documentDeSortie.archivDoc"> <a href="{{delivranceAap.documentDeSortie.archivDoc | generalDownload}}">Télécharger le document signé</a></span>
                                            </div>

                                        </div>

                                        <div *ngIf="delivranceAap.documentDeSortie.retirerPar">
                                            <ng-template mat-tab-label>
                                                <mat-icon>person</mat-icon>
                                            </ng-template>
                                            <!-- Affiche les information de la carte attribution -->
                                            <div  fxLayout="row" fxLayout.lt-md="row wrap"
                                                fxLayoutGap.gt-sm="20px" fxLayoutAlign="start">
                                                <mat-card [fxFlex.xs]="100" [fxFlex.sm]="100" [fxFlex.md]="100" [fxFlex.lg]="100"
                                                    [fxFlex.xl]="100">
                                                    <mat-card-header>
                                                        <mat-card-title>
                                                            Personne ayant retiré le document
                                                        </mat-card-title>
                                                    </mat-card-header>
                                                    <mat-card-content>
                                                        <app-card-general-contribuable-form [contribuable]="delivranceAap.documentDeSortie.retirerPar">
                                                        </app-card-general-contribuable-form>
                                                    </mat-card-content>
                                                </mat-card>
                                            </div>
                                        </div>
                                    </div>
                                </form>
                            </mat-tab>

                            <mat-tab>
                                <form>
                                    <ng-template mat-tab-label>
                                        <mat-icon>business</mat-icon>
                                        Structure
                                    </ng-template>
                                    <div fxLayout="row" fxLayout.sm="row wrap" fxLayout.xs="row wrap" fxLayoutGap.gt-sm="20px"
                                        fxLayoutAlign="start">

                                        <mat-form-field class="sycad-form-line" appearance="outline" [fxFlex.xs]="100"
                                            [fxFlex.sm]="100" [fxFlex.md]="70" [fxFlex.lg]="50" [fxFlex.xl]="50">
                                            <mat-label>Structure</mat-label>
                                            <input matInput value="{{delivranceAap.transmission?.structure?.nom}}" [readonly]="true">
                                        </mat-form-field>

                                    </div>
                                    <div fxLayout="row" fxLayout.sm="row wrap" fxLayout.xs="row wrap" fxLayoutGap.gt-sm="20px"
                                        fxLayoutAlign="start">
                                        <mat-form-field class="sycad-form-line" appearance="outline" [fxFlex.xs]="100"
                                            [fxFlex.sm]="100" [fxFlex.md]="70" [fxFlex.lg]="50" [fxFlex.xl]="50">
                                            <mat-label>Service</mat-label>
                                            <input matInput value="{{delivranceAap.transmission?.service?.nom}}" [readonly]="true">
                                        </mat-form-field>
                                    </div>
                                    <div fxLayout="row" fxLayout.sm="row wrap" fxLayout.xs="row wrap" fxLayoutGap.gt-sm="20px"
                                        fxLayoutAlign="start">
                                        <mat-form-field class="sycad-form-line" appearance="outline" [fxFlex.xs]="100"
                                            [fxFlex.sm]="100" [fxFlex.md]="70" [fxFlex.lg]="50" [fxFlex.xl]="50">
                                            <mat-label>Bureau</mat-label>
                                            <input matInput value="{{delivranceAap.transmission?.bureau?.nom}}" [readonly]="true">
                                        </mat-form-field>
                                    </div>
                                </form>
                            </mat-tab>
                           
                        </mat-tab-group>
                    </form>
                </mat-tab>

                <mat-tab>
                    <form>
                        <ng-template mat-tab-label>
                            <mat-icon>content_paste</mat-icon>
                            Propriété
                        </ng-template>
                        <mat-tab-group>
                            <mat-tab *ngIf="delivranceAap.parcelle">
                                <form>
                                    <ng-template mat-tab-label>
                                        <mat-icon>list_alt</mat-icon>
                                        Parcelle
                                    </ng-template>

                                    <app-parcelle-visualiser [attribution]="delivranceAap"></app-parcelle-visualiser>

                                </form>
                                <app-cycledevie-parcelle [icad]="delivranceAap.parcelle?.icad"></app-cycledevie-parcelle>
                            </mat-tab>
                            <mat-tab *ngIf="delivranceAap.parcelleInexistante">
                                <form>
                                    <ng-template mat-tab-label>
                                        <mat-icon>list_alt</mat-icon>
                                        Parcelle non trouvé
                                    </ng-template>
                                    <div fxLayout="row" fxLayout.lt-md="row wrap" fxLayoutGap.gt-sm="20px" fxLayoutAlign="start">
                                        <mat-form-field class="sycad-form-line" appearance="outline" [fxFlex.xs]="100"
                                            [fxFlex.sm]="100" [fxFlex.md]="45" [fxFlex.lg]="25" [fxFlex.xl]="20">
                                            <mat-label>Commune </mat-label>
                                            <input matInput value="{{delivranceAap.parcelleInexistante.commune.nom}}" [readonly]="true">
                                        </mat-form-field>
                                        <mat-form-field class="sycad-form-line" appearance="outline" [fxFlex.xs]="100"
                                            [fxFlex.sm]="100" [fxFlex.md]="45" [fxFlex.lg]="25" [fxFlex.xl]="20">
                                            <mat-label>Arrondissement</mat-label>
                                            <input matInput value="{{delivranceAap.parcelleInexistante?.arrondissement?.nom}}"
                                                [readonly]="true">
                                        </mat-form-field>
                                    </div> 
                                    
                                    <div fxLayout="row" fxLayout.lt-md="row wrap" fxLayoutGap.gt-sm="20px" fxLayoutAlign="start">
                                        <mat-form-field class="sycad-form-line" appearance="outline" [fxFlex.xs]="100"
                                        [fxFlex.sm]="100" [fxFlex.md]="45" [fxFlex.lg]="25" [fxFlex.xl]="20">
                                            <mat-label>Secteur/Village </mat-label>
                                            <input matInput [attr.autocomplete]="'off'" value="{{delivranceAap.parcelleInexistante?.localite?.nom}}"
                                                [readonly]="true" />
                                        </mat-form-field>
                                        <mat-form-field class="sycad-form-line" appearance="outline" [fxFlex.xs]="100"
                                            [fxFlex.sm]="100" [fxFlex.md]="45" [fxFlex.lg]="25" [fxFlex.xl]="20">
                                            <mat-label>Quartier</mat-label>
                                            <input matInput value="{{delivranceAap.parcelleInexistante?.quartier?.nom}}"
                                                [readonly]="true">
                                        </mat-form-field>
                                    </div>

                                    <div fxLayout="row" fxLayout.lt-md="row wrap" fxLayoutGap.gt-sm="20px" fxLayoutAlign="start">
                                        <mat-form-field class="sycad-form-line" appearance="outline" [fxFlex.xs]="100"
                                            [fxFlex.sm]="100" [fxFlex.md]="45" [fxFlex.lg]="25" [fxFlex.xl]="20">
                                            <mat-label>Section</mat-label>
                                            <input matInput value="{{delivranceAap.parcelleInexistante?.section}}"
                                                [readonly]="true">
                                        </mat-form-field>
                                        <mat-form-field class="sycad-form-line" appearance="outline" [fxFlex.xs]="100"
                                            [fxFlex.sm]="100" [fxFlex.md]="45" [fxFlex.lg]="25" [fxFlex.xl]="20">
                                            <mat-label>Ilot</mat-label>
                                            <input matInput [attr.autocomplete]="'off'" value="{{delivranceAap.parcelleInexistante?.ilot}}"
                                                [readonly]="true" />
                                        </mat-form-field>
                                    </div>
                                    <div fxLayout="row" fxLayout.lt-md="row wrap" fxLayoutGap.gt-sm="20px" fxLayoutAlign="start">
                                        <mat-form-field class="sycad-form-line" appearance="outline" [fxFlex.xs]="100"
                                            [fxFlex.sm]="100" [fxFlex.md]="45" [fxFlex.lg]="25" [fxFlex.xl]="20">
                                            <mat-label>Numéro parcelle</mat-label>
                                            <input matInput  value="{{delivranceAap.parcelleInexistante.numero}}"
                                                [readonly]="true" />
                                        </mat-form-field>
                                        <mat-form-field class="sycad-form-line" appearance="outline" [fxFlex.xs]="100"
                                            [fxFlex.sm]="100" [fxFlex.md]="45" [fxFlex.lg]="25" [fxFlex.xl]="20">
                                            <mat-label>Superficie </mat-label>
                                            <input matInput  value="{{delivranceAap.parcelleInexistante.superficie}}"
                                                [readonly]="true" />
                                        </mat-form-field>
                                    </div>
                                    <div fxLayout="row" fxLayout.lt-md="row wrap" fxLayoutGap.gt-sm="20px" fxLayoutAlign="start">
                                        <mat-form-field class="sycad-form-line" appearance="outline" [fxFlex.xs]="100"
                                            [fxFlex.sm]="100" [fxFlex.md]="45" [fxFlex.lg]="25" [fxFlex.xl]="20">
                                            <mat-label>Destination</mat-label>
                                            <input matInput  value="{{delivranceAap.parcelleInexistante?.destination?.libelle}}"
                                                [readonly]="true" />
                                        </mat-form-field>
                                        <mat-form-field class="sycad-form-line" appearance="outline" [fxFlex.xs]="100"
                                            [fxFlex.sm]="100" [fxFlex.md]="45" [fxFlex.lg]="25" [fxFlex.xl]="20">
                                            <mat-label>Etat de mise en valeur</mat-label>
                                            <input matInput  value="{{delivranceAap.parcelleInexistante?.etatMiseEnValeur}}"
                                                [readonly]="true" />
                                        </mat-form-field>
                                    </div>
                                </form>
                            </mat-tab>
                        </mat-tab-group>
                    </form>
                </mat-tab>

                <mat-tab>
                    <form>
                        <ng-template mat-tab-label>
                            <mat-icon>content_paste</mat-icon>
                            Contribuable
                        </ng-template>
                        <mat-tab-group  [(selectedIndex)]="selectedSubTabIndex">
                            <mat-tab>

                                <ng-template mat-tab-label>
                                    <mat-icon>person</mat-icon>
                                    Attributaire
                                </ng-template>
                                <!-- Affiche les information de la carte attribution -->
                                <div *ngIf="delivranceAap.contribuableBeneficiaire" fxLayout="row" fxLayout.lt-md="row wrap"
                                    fxLayoutGap.gt-sm="20px" fxLayoutAlign="start">
                                    <mat-card [fxFlex.xs]="100" [fxFlex.sm]="100" [fxFlex.md]="100" [fxFlex.lg]="100"
                                        [fxFlex.xl]="100">
                                        <mat-card-header>
                                            <mat-card-title>
                                                Détail Attributaire
                                            </mat-card-title>
                                        </mat-card-header>
                                        <mat-card-content>
                                            <app-card-general-contribuable-form [contribuable]="delivranceAap.contribuableBeneficiaire">
                                            </app-card-general-contribuable-form>
                                        </mat-card-content>
                                    </mat-card>
                                </div>
                            </mat-tab>

                            <mat-tab>
                                <ng-template mat-tab-label>
                                    <mat-icon>move_to_inbox</mat-icon>
                                    Mandats
                                </ng-template>
                                <div fxLayout="row" fxLayout="row wrap" fxLayoutGap.gt-sm="20px" fxLayoutAlign="start">
                                    <table mat-table [dataSource]="dataSourceMandat" class="mat-elevation-z8" [fxFlex.xs]="100"
                                        [fxFlex.sm]="100" [fxFlex.md]="100" [fxFlex.lg]="100" [fxFlex.xl]="70">
                                        <ng-container matColumnDef="objet">
                                            <th mat-header-cell *matHeaderCellDef> Objet </th>
                                            <td mat-cell *matCellDef="let mandat"> {{mandat.objet}} </td>
                                        </ng-container>
                                        <ng-container matColumnDef="debut">
                                            <th mat-header-cell *matHeaderCellDef> Debut </th>
                                            <td mat-cell *matCellDef="let mandat"> {{mandat.debut | date : 'dd/MM/yyyy'}} </td>
                                        </ng-container>
                                        <ng-container matColumnDef="fin">
                                            <th mat-header-cell *matHeaderCellDef> Fin </th>
                                            <td mat-cell *matCellDef="let mandat"> {{mandat.fin | date : 'dd/MM/yyyy'}} </td>
                                        </ng-container>
                                        <ng-container matColumnDef="reference">
                                            <th mat-header-cell *matHeaderCellDef> Reference </th>
                                            <td mat-cell *matCellDef="let mandat"> {{mandat.reference}} </td>
                                        </ng-container>
                                        <ng-container matColumnDef="description">
                                            <th mat-header-cell *matHeaderCellDef> Description </th>
                                            <td mat-cell *matCellDef="let mandat"> {{mandat.description}} </td>
                                        </ng-container>
                                        <ng-container matColumnDef="mandant">
                                            <th mat-header-cell *matHeaderCellDef>Mandant </th>
                                            <td mat-cell *matCellDef="let mandat"> {{mandat.mandant?.libelle}} </td>
                                        </ng-container>
                                        <ng-container matColumnDef="mandataire">
                                            <th mat-header-cell *matHeaderCellDef>Mandataire </th>
                                            <td mat-cell *matCellDef="let mandat"> {{mandat.mandataire?.libelle}} </td>
                                        </ng-container>
                                        <ng-container matColumnDef="action">
                                            <th mat-header-cell *matHeaderCellDef> Piece jointe </th>
                                            <td mat-cell *matCellDef="let mandat">
                                                <a href="{{mandat.pieceJointe | generalDownload}}" target="_blank" color="primary">
                                                    Telecharger</a>
                                            </td>
                                        </ng-container>

                                        <tr mat-header-row *matHeaderRowDef="displayedColumnsMandat"></tr>
                                        <tr mat-row *matRowDef="let row; columns: displayedColumnsMandat;"></tr>
                                    </table>
                                </div>
                            </mat-tab>
                        </mat-tab-group>
                    </form>
                </mat-tab>

                <mat-tab>
                    <form>
                        <ng-template mat-tab-label>
                            <mat-icon>content_paste</mat-icon>
                            Fiscalite
                        </ng-template>
                        <mat-tab-group>
                            <mat-tab *ngIf="delivranceAap.quittances">
                                <ng-template mat-tab-label>
                                    <mat-icon>person</mat-icon>
                                    Quittances
                                </ng-template>
                                <div fxLayout="row" fxLayout.lt-md="row wrap" fxLayoutGap.gt-sm="20px" fxLayoutAlign="start">

                                    <table mat-table [dataSource]="dataSourceQuittance" class="mat-elevation-z8" [fxFlex.xs]="100"
                                        [fxFlex.sm]="100" [fxFlex.md]="100" [fxFlex.lg]="100" [fxFlex.xl]="70">
                                        <ng-container matColumnDef="reference">
                                            <th mat-header-cell *matHeaderCellDef> Reférence </th>
                                            <td mat-cell *matCellDef="let quittance"> {{quittance.reference}} </td>
                                        </ng-container>
                                        <ng-container matColumnDef="date">
                                            <th mat-header-cell *matHeaderCellDef> Date </th>
                                            <td mat-cell *matCellDef="let quittance"> {{quittance.date | date : 'dd/MM/yyyy'}} </td>
                                        </ng-container>
                                        <ng-container matColumnDef="montant">
                                            <th mat-header-cell *matHeaderCellDef> Montant </th>
                                            <td mat-cell *matCellDef="let quittance"> {{quittance.montant}} Fcfa </td>
                                        </ng-container>

                                        <tr mat-header-row *matHeaderRowDef="displayedColumnsQuittance"></tr>
                                        <tr mat-row *matRowDef="let row; columns: displayedColumnsQuittance;"></tr>
                                    </table>
                                </div>
                            </mat-tab>
                        </mat-tab-group>
                    </form>
                </mat-tab>


                <mat-tab>
                    <ng-template mat-tab-label>
                        <mat-icon>chrome_reader_mode</mat-icon>&nbsp;Historique
                    </ng-template>
                    <div fxLayout="row" fxLayoutAlign="start">
                        <div [fxFlex.xs]="100" [fxFlex.sm]="100" [fxFlex.md]="100" [fxFlex.lg]="50" [fxFlex.xl]="60">
                            <app-historique [numero]="delivranceAap.numero"></app-historique>
                        </div>

                    </div>
                </mat-tab>
            </mat-tab-group>
        </mat-card-content>
    </form>
</mat-card>
